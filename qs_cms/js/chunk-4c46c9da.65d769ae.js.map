{"version":3,"sources":["webpack:///./src/views/power/Role.vue?6738","webpack:///./src/views/power/Role.vue?a24a","webpack:///src/views/power/Role.vue","webpack:///./src/views/power/Role.vue?505b","webpack:///./src/views/power/Role.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","$route","meta","on","$event","getRoleList","scopedSlots","_u","key","fn","staticStyle","model","value","queryInfo","callback","$$v","$set","expression","proxy","$PowerKey","powerKey","RolePowerKey","RoleAdd","RoleDiaLog","roleInfo","postNum","_v","_e","roleList","val","RoleUpdateStatus","row","status","handleSwitchChange","RoleUpdate","handleEditRole","id","RoleInfo","handleLoadRole","RolePriv","handleRightChange","listTotal","handleCloseDialog","$refs","RoleRef","handleSureRole","ref","roleForm","formRules","editRight","handleCloseEditRight","handleSureRightChange","rightList","checkedKeys","defaultProps","staticRenderFns","name","created","roleBtnList","powerList","path","mounted","computed","data","pageParam","page","pageSize","memo","roleId","children","label","methods","some","$confirm","type","resetFields","validate","res","SureAddRole","console","log","amendData","forEach","reg","test","v","processData","hasOwnProperty","length","components","Breadcrumb","Pagination","component"],"mappings":"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","file":"js/chunk-4c46c9da.65d769ae.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Role.vue?vue&type=style&index=0&id=c31cfcdc&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Role.vue?vue&type=style&index=0&id=c31cfcdc&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"role\"},[_c('breadcrumb',{attrs:{\"routeMeta\":_vm.$route.meta}}),_c('el-card',[_c('el-row',{attrs:{\"gutter\":20}},[_c('el-col',{attrs:{\"span\":8}},[_c('el-input',{attrs:{\"placeholder\":\"请输入需要查找的用户名\",\"clearable\":\"\"},on:{\"clear\":function($event){return _vm.getRoleList()}},scopedSlots:_vm._u([{key:\"prepend\",fn:function(){return [_c('el-select',{staticStyle:{\"width\":\"100px\"},attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.queryInfo.status),callback:function ($$v) {_vm.$set(_vm.queryInfo, \"status\", $$v)},expression:\"queryInfo.status\"}},[_c('el-option',{attrs:{\"label\":\"全部\",\"value\":null}}),_c('el-option',{attrs:{\"label\":\"有效\",\"value\":1}}),_c('el-option',{attrs:{\"label\":\"无效\",\"value\":0}})],1)]},proxy:true},{key:\"append\",fn:function(){return [_c('el-button',{attrs:{\"icon\":\"el-icon-search\"},on:{\"click\":function($event){return _vm.getRoleList()}}})]},proxy:true}]),model:{value:(_vm.queryInfo.name),callback:function ($$v) {_vm.$set(_vm.queryInfo, \"name\", $$v)},expression:\"queryInfo.name\"}})],1),_c('el-col',{attrs:{\"span\":4}},[(_vm.$PowerKey(_vm.powerKey.RolePowerKey.RoleAdd))?_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.RoleDiaLog.roleInfo = true;_vm.postNum=1;}}},[_vm._v(\"添加角色\")]):_vm._e()],1)],1),_c('el-divider'),_c('el-table',{attrs:{\"data\":_vm.roleList,\"border\":\"\",\"stripe\":\"\"}},[_c('el-table-column',{attrs:{\"type\":\"index\",\"label\":\"#\"}}),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"角色\"}}),_c('el-table-column',{attrs:{\"prop\":\"subsystem_name\",\"label\":\"所属子系统\"}}),_c('el-table-column',{attrs:{\"prop\":\"memo\",\"label\":\"描述\"}}),_c('el-table-column',{attrs:{\"prop\":\"create_time\",\"label\":\"创建时间\"}}),_c('el-table-column',{attrs:{\"prop\":\"status\",\"label\":\"状态\",\"width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(val){return [_c('el-switch',{attrs:{\"disabled\":!_vm.$PowerKey(_vm.powerKey.RolePowerKey.RoleUpdateStatus),\"value\":val.row.status == 1},on:{\"change\":function($event){return _vm.handleSwitchChange(val.row)}}})]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"300\"},scopedSlots:_vm._u([{key:\"default\",fn:function(val){return [(_vm.$PowerKey(_vm.powerKey.RolePowerKey.RoleUpdate))?_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"primary\",\"icon\":\"el-icon-edit\"},on:{\"click\":function($event){return _vm.handleEditRole(val.row.id)}}},[_vm._v(\"编辑\")]):_vm._e(),(_vm.$PowerKey(_vm.powerKey.RolePowerKey.RoleInfo))?_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"danger\",\"icon\":\"el-icon-refresh\"},on:{\"click\":function($event){return _vm.handleLoadRole(val.row)}}},[_vm._v(\"重载\")]):_vm._e(),(_vm.$PowerKey(_vm.powerKey.RolePowerKey.RolePriv))?_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"warning\",\"icon\":\"el-icon-s-tools\"},on:{\"click\":function($event){return _vm.handleRightChange(val.row)}}},[_vm._v(\"分配权限\")]):_vm._e()]}}])})],1),_c('pagination',{attrs:{\"total\":_vm.listTotal,\"pageSizes\":[5, 10, 20],\"queryInfo\":_vm.queryInfo,\"queryFunc\":_vm.getRoleList}})],1),_c('el-dialog',{attrs:{\"title\":_vm.postNum==1?'添加角色':'修改角色',\"visible\":_vm.RoleDiaLog.roleInfo,\"width\":\"40%\"},on:{\"update:visible\":function($event){return _vm.$set(_vm.RoleDiaLog, \"roleInfo\", $event)},\"close\":function($event){return _vm.handleCloseDialog(_vm.$refs.RoleRef)}},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('span',{staticClass:\"dialog-footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.RoleDiaLog.roleInfo = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.handleSureRole(_vm.postNum)}}},[_vm._v(\"确 定\")])],1)]},proxy:true}])},[_c('el-form',{ref:\"RoleRef\",attrs:{\"model\":_vm.roleForm,\"status-icon\":\"\",\"rules\":_vm.formRules,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"角色名\",\"prop\":\"name\"}},[_c('el-input',{model:{value:(_vm.roleForm.name),callback:function ($$v) {_vm.$set(_vm.roleForm, \"name\", $$v)},expression:\"roleForm.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"描述\",\"prop\":\"memo\"}},[_c('el-input',{attrs:{\"type\":\"text\"},model:{value:(_vm.roleForm.memo),callback:function ($$v) {_vm.$set(_vm.roleForm, \"memo\", $$v)},expression:\"roleForm.memo\"}})],1)],1)],1),_c('el-dialog',{attrs:{\"title\":\"分配角色权限\",\"visible\":_vm.RoleDiaLog.editRight,\"width\":\"30%\"},on:{\"update:visible\":function($event){return _vm.$set(_vm.RoleDiaLog, \"editRight\", $event)},\"close\":_vm.handleCloseEditRight},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('el-button',{on:{\"click\":function($event){_vm.RoleDiaLog.editRight = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleSureRightChange}},[_vm._v(\"确 定\")])]},proxy:true}])},[_c('div',{staticClass:\"dia_body\"},[_c('el-tree',{ref:\"treeRef\",attrs:{\"data\":_vm.rightList,\"show-checkbox\":\"\",\"default-expand-all\":\"\",\"default-checked-keys\":_vm.checkedKeys,\"node-key\":\"id\",\"highlight-current\":\"\",\"props\":_vm.defaultProps,\"expand-on-click-node\":false,\"check-on-click-node\":\"\"}})],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"role\">\n    <!-- 主体页面 开始 -->\n    <!-- 面包屑 -->\n    <breadcrumb :routeMeta=\"$route.meta\"></breadcrumb>\n    <!-- 卡片 -->\n    <el-card>\n      <el-row :gutter=\"20\">\n        <!-- 搜索框 -->\n        <el-col :span=\"8\">\n          <el-input\n            @clear=\"getRoleList()\"\n            v-model=\"queryInfo.name\"\n            placeholder=\"请输入需要查找的用户名\"\n            clearable\n          >\n            <template #prepend>\n              <el-select v-model=\"queryInfo.status\" placeholder=\"请选择\" style=\"width:100px\">\n                <el-option label=\"全部\" :value=\"null\"></el-option>\n                <el-option label=\"有效\" :value=\"1\"></el-option>\n                <el-option label=\"无效\" :value=\"0\"></el-option>\n              </el-select>\n            </template>\n            <template #append>\n              <el-button icon=\"el-icon-search\" @click=\"getRoleList()\"></el-button>\n            </template>\n          </el-input>\n        </el-col>\n        <!-- 添加用户框  -->\n        <el-col :span=\"4\">\n          <el-button\n            v-if=\"$PowerKey(powerKey.RolePowerKey.RoleAdd)\"\n            type=\"primary\"\n            @click=\"RoleDiaLog.roleInfo = true;postNum=1;\"\n          >添加角色</el-button>\n        </el-col>\n      </el-row>\n      <el-divider></el-divider>\n\n      <!-- 用户数据展示的表格 -->\n      <el-table :data=\"roleList\" border stripe>\n        <el-table-column type=\"index\" label=\"#\"></el-table-column>\n        <el-table-column prop=\"name\" label=\"角色\"></el-table-column>\n        <el-table-column prop=\"subsystem_name\" label=\"所属子系统\"></el-table-column>\n        <el-table-column prop=\"memo\" label=\"描述\"></el-table-column>\n        <el-table-column prop=\"create_time\" label=\"创建时间\"></el-table-column>\n        <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\n          <!-- 这里用了作用域插槽，该插槽可以获取子组件的数据 -->\n          <template #default=\"val\">\n            <el-switch\n              :disabled=\"!$PowerKey(powerKey.RolePowerKey.RoleUpdateStatus)\"\n              :value=\"val.row.status == 1\"\n              @change=\"handleSwitchChange(val.row)\"\n            ></el-switch>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作\" width=\"300\">\n          <template #default=\"val\">\n            <!-- 修改 -->\n            <el-button\n              size=\"mini\"\n              type=\"primary\"\n              icon=\"el-icon-edit\"\n              @click=\"handleEditRole(val.row.id)\"\n              v-if=\"$PowerKey(powerKey.RolePowerKey.RoleUpdate)\"\n            >编辑</el-button>\n            <!-- 重载 -->\n            <el-button\n              size=\"mini\"\n              type=\"danger\"\n              icon=\"el-icon-refresh\"\n              @click=\"handleLoadRole(val.row)\"\n              v-if=\"$PowerKey(powerKey.RolePowerKey.RoleInfo)\"\n            >重载</el-button>\n            <!-- 分配 -->\n            <el-button\n              @click=\"handleRightChange(val.row)\"\n              size=\"mini\"\n              type=\"warning\"\n              icon=\"el-icon-s-tools\"\n              v-if=\"$PowerKey(powerKey.RolePowerKey.RolePriv)\"\n            >分配权限</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      <!-- 分页 -->\n      <pagination\n        :total=\"listTotal\"\n        :pageSizes=\"[5, 10, 20]\"\n        :queryInfo=\"queryInfo\"\n        :queryFunc=\"getRoleList\"\n      ></pagination>\n    </el-card>\n    <!-- 主体页面 结束 -->\n\n    <!-- 功能弹窗 开始 -->\n    <!-- 角色的弹窗 开始-->\n    <el-dialog\n      :title=\"postNum==1?'添加角色':'修改角色'\"\n      :visible.sync=\"RoleDiaLog.roleInfo\"\n      width=\"40%\"\n      @close=\"handleCloseDialog($refs.RoleRef)\"\n    >\n      <el-form ref=\"RoleRef\" :model=\"roleForm\" status-icon :rules=\"formRules\" label-width=\"80px\">\n        <el-form-item label=\"角色名\" prop=\"name\">\n          <el-input v-model=\"roleForm.name\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"描述\" prop=\"memo\">\n          <el-input type=\"text\" v-model=\"roleForm.memo\"></el-input>\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"RoleDiaLog.roleInfo = false\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"handleSureRole(postNum)\">确 定</el-button>\n        </span>\n      </template>\n    </el-dialog>\n    <!-- 弹窗 结束 -->\n\n    <!-- 分配角色权限 开始 -->\n    <el-dialog\n      title=\"分配角色权限\"\n      :visible.sync=\"RoleDiaLog.editRight\"\n      width=\"30%\"\n      @close=\"handleCloseEditRight\"\n    >\n      <div class=\"dia_body\">\n        <el-tree\n          :data=\"rightList\"\n          show-checkbox\n          default-expand-all\n          :default-checked-keys=\"checkedKeys\"\n          node-key=\"id\"\n          ref=\"treeRef\"\n          highlight-current\n          :props=\"defaultProps\"\n          :expand-on-click-node=\"false\"\n          check-on-click-node\n        ></el-tree>\n      </div>\n      <template #footer class=\"dialog-footer\">\n        <el-button @click=\"RoleDiaLog.editRight = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"handleSureRightChange\">确 定</el-button>\n      </template>\n    </el-dialog>\n    <!-- 分配角色权限 结束 -->\n\n    <!-- 功能弹窗 结束 -->\n  </div>\n</template>\n\n<script>\nimport {\n  getRolerListApi,\n  getSubsystemListApi,\n  getSysRoleAdd,\n  getSysRoleInfo,\n  getSysRoleUpdate,\n  getSysRoleUpdateStatus,\n  sysRolePrivListApi,\n  sysRolePrivSaveApi\n} from \"@/api/api\";\nimport { post } from \"@/axios/index.js\";\n\nimport Breadcrumb from \"@/components/Breadcrumb.vue\";\nimport Pagination from \"@/components/Pagination.vue\";\n\nimport { mapState } from \"vuex\";\n\nexport default {\n  name: \"roles\",\n  created() {\n    // 按钮权限\n    this.roleBtnList = this.powerList[this.$route.path];\n  },\n  mounted() {\n    this.getRoleList();\n    // this.getRoleItemList();\n  },\n  computed: {\n    ...mapState(\"menu\", [\"powerList\"])\n  },\n  data() {\n    return {\n      postNum: null,\n      roleBtnList: [],\n      listTotal: null,\n      // 查询信息\n      queryInfo: {\n        name: \"\",\n        status: null,\n        pageParam: {\n          page: 1,\n          pageSize: 5\n        }\n      },\n\n      // 弹窗的打开判断\n      RoleDiaLog: {\n        roleInfo: false,\n        editRight: false\n      },\n      // 角色表单\n      roleForm: {\n        name: \"\",\n        memo: \"\"\n      },\n      // roleItem: [],\n\n      formRules: {\n        name: [\n          { required: true, message: \"请输入角色名\", trigger: \"blur\" },\n          { min: 3, max: 9, message: \"长度在 3 到 9 个字符\", trigger: \"blur\" }\n        ],\n        memo: [\n          { required: true, message: \"请输入描述信息\", trigger: \"blur\" },\n          { min: 4, max: 50, message: \"长度在 4 到 50 个字符\", trigger: \"blur\" }\n        ]\n      },\n      roleList: [],\n      roleId: null,\n      /**\n       * 树形 权限\n       */\n      rightList: [],\n      checkedKeys: [],\n      defaultProps: {\n        children: \"List\",\n        label: \"name\"\n      }\n    };\n  },\n  methods: {\n    $PowerKey(str) {\n      return this.roleBtnList && this.roleBtnList.some(v => v.name_en == str);\n    },\n    async getRoleList() {\n      let res = await getRolerListApi(this.queryInfo);\n\n      // console.log(res);\n\n      this.roleList = res.value;\n\n      (!this.listTotal || this.listTotal != res.num) &&\n        (this.listTotal = res.num);\n    },\n    // async getRoleItemList() {\n    //   let res = await getSubsystemListApi();\n    //   this.roleItem = res.value;\n    // },\n    // 切换 状态\n    handleSwitchChange(row) {\n      this.$confirm(\"确定要修改该用户的状态?\", \"提示\", {\n        type: \"warning\"\n      }).then(\n        async () => {\n          // 调用 修改状态的接口 row.id\n          // console.log(row);\n          row.status = row.status === 1 ? 0 : 1;\n          let params = {\n            id: row.id,\n            status: row.status\n          };\n          // 弹窗提示\n          let res = await getSysRoleUpdateStatus(params);\n          if (res.code == 10000) {\n            this.getRoleList();\n            this.$message.success(res.message);\n          }\n        },\n        () => {\n          console.log(\"点击了取消\");\n        }\n      );\n    },\n    // 关闭 dialog 弹窗\n    handleCloseDialog(ref) {\n      // 1. 清空表单信息\n      this.roleForm = {\n        name: \"\",\n        memo: \"\"\n      };\n\n      this.postNum = null;\n\n      ref && ref.resetFields();\n    },\n    // 操作按钮\n\n    handleSureRole(postNum) {\n      this.$refs.RoleRef.validate(res => {\n        // 表单验证不合格，就返回\n        if (!res) {\n          return;\n        }\n\n        if (postNum == 1) {\n          this.SureAddRole();\n        } else if (postNum == 2) {\n          this.SureEditRole();\n        }\n      });\n    },\n\n    // 弹出修改窗口\n    async handleEditRole(id) {\n      // 1. 根据 id 从 后台获取该用户的最新信息，显示在弹窗里\n      this.roleId = id;\n      this.RoleDiaLog.roleInfo = true;\n      this.postNum = 2;\n\n      let params = {\n        id: id\n      };\n      let res = await getSysRoleInfo(params);\n      this.roleForm.name = res.value.name;\n      this.roleForm.memo = res.value.memo;\n      // 2. 显示修改信息弹窗\n    },\n    SureAddRole() {\n      // 表单验证通过\n      this.$confirm(\"确定要添加该角色?\", \"提示\", {\n        type: \"warning\"\n      }).then(\n        async () => {\n          // 调用 添加角色的接口\n          // let params = {\n          //   name: this.roleForm.name,\n          //   memo: this.roleForm.memo\n          // };\n          // console.log(params);\n\n          let res = await getSysRoleAdd(this.roleForm);\n\n          if (res.code != 10000) {\n            this.$message.error(res.message);\n            return (this.RoleDiaLog.roleInfo = false);\n          }\n\n          this.getRoleList();\n          // 弹窗提示\n          this.$message.success(res.message);\n          this.RoleDiaLog.roleInfo = false;\n        },\n        () => {\n          console.log(\"点击了取消\");\n        }\n      );\n    },\n    // 确定修改角色信息\n    async SureEditRole() {\n      // 1. 发送请求，修改角色信息\n\n      let params = {\n        id: this.roleId,\n        memo: this.roleForm.memo,\n        name: this.roleForm.name\n      };\n      let res = await getSysRoleUpdate(params);\n\n      if (res.code != 10000) {\n        this.$message.error(res.message);\n        return (this.RoleDiaLog.roleInfo = false);\n      }\n\n      this.getRoleList();\n      // 弹窗提示\n      this.$message.success(res.message);\n      this.RoleDiaLog.roleInfo = false;\n    },\n    async handleLoadRole(row) {\n      // row 是 当前选择的 列表行\n      console.log(row);\n      // 通过发送给后台的 API，去修改该行的数据\n      let res = await getSysRoleInfo({ id: row.id });\n\n      if (res.code != 10000) {\n        return this.$message.error(res.message);\n      }\n      let val = res.value;\n      row = {\n        ...val\n      };\n\n      this.$message.success(res.message);\n    },\n\n    // 弹出权限修改窗口\n    async handleRightChange(row) {\n      this.roleId = row.id;\n      this.RoleDiaLog.editRight = true;\n\n      // 1. 发送请求，获取角色的权限列表\n      let res = await sysRolePrivListApi({ id: row.id });\n\n      if (res.code != 10000) {\n        return this.$message.error(res.message);\n      }\n\n      this.rightList = res.value.oneMenuList;\n      console.log(this.rightList);\n\n      this.amendData(this.rightList);\n    },\n\n    // 确定修改角色\n    async handleSureRightChange() {\n      // 1. 传给后端\n      // console.log(this.$refs.treeRef.getCheckedKeys());\n      let priv_ids = this.$refs.treeRef.getCheckedKeys();\n      let priv_idf = this.$refs.treeRef.getHalfCheckedKeys();\n\n      console.log(priv_idf, priv_ids);\n\n      let res = await sysRolePrivSaveApi({\n        priv_id: [...priv_idf, ...priv_ids],\n        role_id: this.roleId\n      });\n\n      console.log(res);\n\n      if (res.code != 10000) {\n        return this.$message.error(res.message);\n      }\n\n      this.$message.success(res.message);\n\n      this.RoleDiaLog.editRight = false;\n      console.log(\"修改权限\");\n    },\n\n    // 关闭权限修改窗口\n    handleCloseEditRight() {\n      this.rightList = [];\n      this.checkedKeys = [];\n      this.roleId = null;\n      console.log(\"关闭权限\");\n    },\n\n    /**\n     * 工具函数\n     */\n    // 修改后端传递过来的数据\n    amendData(data) {\n      if (!data) {\n        return;\n      }\n      let reg = /.+List/;\n      data.forEach(v => {\n        for (const key in v) {\n          if (reg.test(key)) {\n            v[\"List\"] = v[key];\n            delete v[key];\n            this.amendData(v[\"List\"]);\n          }\n        }\n      });\n\n      this.processData(data);\n    },\n    // 处理数据，给数据加勾选\n    processData(data) {\n      data.forEach(v => {\n        if (v.hasOwnProperty(\"List\") && v[\"List\"].length != 0) {\n          this.processData(v[\"List\"]);\n        } else {\n          if (v[\"checked\"] == true) {\n            this.checkedKeys.push(v[\"id\"]); // 添加默认勾选的选项\n          }\n        }\n      });\n    }\n  },\n  components: {\n    Breadcrumb,\n    Pagination\n  }\n};\n</script>\n\n<style scoped>\n.dia_body {\n  height: 400px;\n  overflow: auto;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Role.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Role.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Role.vue?vue&type=template&id=c31cfcdc&scoped=true&\"\nimport script from \"./Role.vue?vue&type=script&lang=js&\"\nexport * from \"./Role.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Role.vue?vue&type=style&index=0&id=c31cfcdc&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c31cfcdc\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}